<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configuring Shadowed Dependencies</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/shadow-new-site/assets/css/0.styles.055f8d43.css" as="style"><link rel="preload" href="/shadow-new-site/assets/js/app.28cb96ad.js" as="script"><link rel="preload" href="/shadow-new-site/assets/js/10.31bb0902.js" as="script"><link rel="prefetch" href="/shadow-new-site/assets/js/2.8d45b1a8.js"><link rel="prefetch" href="/shadow-new-site/assets/js/3.e63935d0.js"><link rel="prefetch" href="/shadow-new-site/assets/js/4.ef76d88a.js"><link rel="prefetch" href="/shadow-new-site/assets/js/5.1cf54d4e.js"><link rel="prefetch" href="/shadow-new-site/assets/js/6.a93a243a.js"><link rel="prefetch" href="/shadow-new-site/assets/js/7.f9af4b19.js"><link rel="prefetch" href="/shadow-new-site/assets/js/8.64cae3fe.js"><link rel="prefetch" href="/shadow-new-site/assets/js/9.29397b9c.js"><link rel="prefetch" href="/shadow-new-site/assets/js/11.befb27c9.js"><link rel="prefetch" href="/shadow-new-site/assets/js/12.ce790460.js"><link rel="prefetch" href="/shadow-new-site/assets/js/13.70d573cc.js"><link rel="prefetch" href="/shadow-new-site/assets/js/14.9edb7769.js"><link rel="prefetch" href="/shadow-new-site/assets/js/15.cb5b2406.js"><link rel="prefetch" href="/shadow-new-site/assets/js/16.a37c97db.js"><link rel="prefetch" href="/shadow-new-site/assets/js/17.f3a08836.js"><link rel="prefetch" href="/shadow-new-site/assets/js/18.cb4cc093.js"><link rel="prefetch" href="/shadow-new-site/assets/js/19.17e53fd5.js"><link rel="prefetch" href="/shadow-new-site/assets/js/20.8268d1ae.js"><link rel="prefetch" href="/shadow-new-site/assets/js/21.ff2c1e5c.js">
    <link rel="stylesheet" href="/shadow-new-site/assets/css/0.styles.055f8d43.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/shadow-new-site/" class="home-link router-link-active"><img src="/shadow-new-site/logo+type.svg" alt="" class="logo"> <!----></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/shadow-new-site/introduction/" class="nav-link">User Guide</a></div> <a href="https://github.com/johnrengelman/shadow" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/shadow-new-site/introduction/" class="nav-link">User Guide</a></div> <a href="https://github.com/johnrengelman/shadow" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/shadow-new-site/" class="sidebar-link">Home</a></li><li><a href="/shadow-new-site/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/shadow-new-site/getting-started/" class="sidebar-link">Getting Started</a></li><li><a href="/shadow-new-site/configuration/" class="sidebar-link">Configuring Shadow</a></li><li><a href="/shadow-new-site/configuration/filtering/" class="sidebar-link">Filtering Shadow Jar Contents</a></li><li><a href="/shadow-new-site/configuration/dependencies/" class="active sidebar-link">Configuring Shadowed Dependencies</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/shadow-new-site/configuration/dependencies/#embedding-jar-files-inside-your-shadow-jar" class="sidebar-link">Embedding Jar Files Inside Your Shadow Jar</a></li><li class="sidebar-sub-header"><a href="/shadow-new-site/configuration/dependencies/#filtering-dependencies" class="sidebar-link">Filtering Dependencies</a></li></ul></li><li><a href="/shadow-new-site/configuration/merging/" class="sidebar-link">Controlling JAR Content Merging</a></li><li><a href="/shadow-new-site/configuration/relocation/" class="sidebar-link">Relocating Packages</a></li><li><a href="/shadow-new-site/configuration/minimizing/" class="sidebar-link">Minimizing</a></li><li><a href="/shadow-new-site/configuration/reproducible-builds/" class="sidebar-link">Reproducible Builds</a></li><li><a href="/shadow-new-site/custom-tasks/" class="sidebar-link">Creating a Custom ShadowJar Task</a></li><li><a href="/shadow-new-site/application-plugin/" class="sidebar-link">Integrating with Application Plugin</a></li><li><a href="/shadow-new-site/publishing/" class="sidebar-link">Publishing Shadow JARs</a></li><li><a href="/shadow-new-site/multi-project/" class="sidebar-link">Using Shadow in Multi-Project Builds</a></li><li><a href="/shadow-new-site/plugins/" class="sidebar-link">Using Shadow to Package Gradle Plugins</a></li><li><a href="/shadow-new-site/changes/" class="sidebar-link">Change Log</a></li><li><a href="/shadow-new-site/about/" class="sidebar-link">About This Project</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="configuring-shadowed-dependencies"><a href="#configuring-shadowed-dependencies" aria-hidden="true" class="header-anchor">#</a> Configuring Shadowed Dependencies</h1> <p>Shadow configures the default <code>shadowJar</code> task to merge all dependencies from the project's <code>runtime</code> configuration
into the final JAR.
The configurations to from which to source dependencies for the merging can be configured using the <code>configurations</code> property
of the <a href="http://imperceptiblethoughts.com/shadow-new-site/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html" target="_blank" rel="noopener noreferrer"><code>ShadowJar</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> task type.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code>shadowJar <span class="token punctuation">{</span>
  configurations <span class="token operator">=</span> <span class="token punctuation">[</span>project<span class="token operator">.</span>configurations<span class="token operator">.</span>compile<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code sample would configure the <code>shadowJar</code> task to merge depdencies from only the <code>compile</code> configuration.
This means any dependency declared in the <code>runtime</code> configuration would be <strong>not</strong> be included in the final JAR.</p> <blockquote><p>Note the literal use of <code>project.configurations</code> when setting the <code>configurations</code> attribute of a
<a href="http://imperceptiblethoughts.com/shadow-new-site/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html" target="_blank" rel="noopener noreferrer"><code>ShadowJar</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> task.
This is <strong>required</strong>. It maybe be tempting to specify <code>configurations = [configurations.compile]</code> but this will not
have the intended effect, as <code>configurations.compile</code> will try to delegate to the <code>configurations</code> property of the
the <a href="http://imperceptiblethoughts.com/shadow-new-site/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html" target="_blank" rel="noopener noreferrer"><code>ShadowJar</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> task instead of the <code>project</code></p></blockquote> <h2 id="embedding-jar-files-inside-your-shadow-jar"><a href="#embedding-jar-files-inside-your-shadow-jar" aria-hidden="true" class="header-anchor">#</a> Embedding Jar Files Inside Your Shadow Jar</h2> <p>Because of the way that Gradle handles dependency configuration, from a plugin perspective, shadow is unable to
distinguish between a jar file configured as a dependency and a jar file included in the resource folder.  This means
that any jar found in a resource directory will be merged into the shadow jar the same as any other dependency.  If
your intention is to embed the jar inside, you must rename the jar as to not end with <code>.jar</code> before the shadow task
begins.</p> <h2 id="filtering-dependencies"><a href="#filtering-dependencies" aria-hidden="true" class="header-anchor">#</a> Filtering Dependencies</h2> <p>Individual dependencies can be filtered from the final JAR by using the <code>dependencies</code> block of a
<a href="http://imperceptiblethoughts.com/shadow-new-site/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html" target="_blank" rel="noopener noreferrer"><code>ShadowJar</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> task.
Dependency filtering does <strong>not</strong> apply to transitive dependencies.
That is, excluding a dependency does not exclude any of its dependencies from the final JAR.</p> <p>The <code>dependency</code> blocks provides a number of methods for resolving dependencies using the notations familiar from
Gradle's <code>configurations</code> block.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Exclude an Module Dependency</span>
dependencies <span class="token punctuation">{</span>
   compile <span class="token string">'shadow:d:1.0'</span>
<span class="token punctuation">}</span>

shadowJar <span class="token punctuation">{</span>
   dependencies <span class="token punctuation">{</span>
      <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token function">dependency</span><span class="token punctuation">(</span><span class="token string">'shadow:d:1.0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Exclude a Project Dependency</span>
dependencies <span class="token punctuation">{</span>
  compile <span class="token function">project</span><span class="token punctuation">(</span><span class="token string">':client'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

shadowJar <span class="token punctuation">{</span>
   dependencies <span class="token punctuation">{</span>
       <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token function">project</span><span class="token punctuation">(</span><span class="token string">':client'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>While not being able to filter entire transitive dependency graphs might seem like an oversight, it is necessary
because it would not be possible to intelligently determine the build author's intended results when there is a
common dependency between two 1st level dependencies when one is excluded and the other is not.</p></blockquote> <h3 id="using-regex-patterns-to-filter-dependencies"><a href="#using-regex-patterns-to-filter-dependencies" aria-hidden="true" class="header-anchor">#</a> Using Regex Patterns to Filter Dependencies</h3> <p>Dependencies can be filtered using regex patterns.
Coupled with the <code>&lt;group&gt;:&lt;artifact&gt;:&lt;version&gt;</code> notation for dependencies, this allows for excluding/including
using any of these individual fields.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Exclude Any Version of a Dependency</span>
dependencies <span class="token punctuation">{</span>
   compile <span class="token string">'shadow:d:1.0'</span>
<span class="token punctuation">}</span>

shadowJar <span class="token punctuation">{</span>
   dependencies <span class="token punctuation">{</span>
      <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token function">dependency</span><span class="token punctuation">(</span><span class="token string">'shadow:d:.*'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Any of the individual fields can be safely absent and will function as though a wildcard was specified.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Ignore Dependency Version</span>
shadowJar <span class="token punctuation">{</span>
  dependencies <span class="token punctuation">{</span>
    <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token function">dependency</span><span class="token punctuation">(</span><span class="token string">'shadow:d'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code snippet is functionally equivalent to the previous example.</p> <p>This same patten can be used for any of the dependency notation fields.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Ignoring An Artifact Regardless of Group</span>
shadowJar <span class="token punctuation">{</span>
  dependencies <span class="token punctuation">{</span>
    <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token function">dependency</span><span class="token punctuation">(</span><span class="token string">':d:1.0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Excluding All Artifacts From Group</span>
shadowJar <span class="token punctuation">{</span>
  dependencies <span class="token punctuation">{</span>
    <span class="token function">exclude</span><span class="token punctuation">(</span><span class="token function">dependency</span><span class="token punctuation">(</span><span class="token string">'shadow::1.0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="programmatically-selecting-dependencies-to-filter"><a href="#programmatically-selecting-dependencies-to-filter" aria-hidden="true" class="header-anchor">#</a> Programmatically Selecting Dependencies to Filter</h3> <p>If more complex decisions are needed to select the dependencies to be included, the
<a href="http://imperceptiblethoughts.com/shadow-new-site/api/com/github/jengelman/gradle/plugins/shadow/tasks/ShadowJar.html#dependencies(Action%3CDependencyFilter%3E)" target="_blank" rel="noopener noreferrer"><code>dependencies</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>
block provides a method that accepts a <code>Closure</code> for selecting dependencies.</p> <div class="language-groovy extra-class"><pre class="language-groovy"><code><span class="token comment">// Selecting Dependencies to Filter With a Spec</span>
shadowJar <span class="token punctuation">{</span>
   dependencies <span class="token punctuation">{</span>
       <span class="token function">exclude</span><span class="token punctuation">(</span>dependency <span class="token punctuation">{</span>
           it<span class="token operator">.</span>moduleGroup <span class="token operator">==</span> <span class="token string">'junit'</span>
       <span class="token punctuation">}</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/johnrengelman/shadow/edit/master/src/docs/vuepress/configuration/dependencies/README.md" target="_blank" rel="noopener noreferrer">Help improve these docs!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/shadow-new-site/configuration/filtering/" class="prev">
          Filtering Shadow Jar Contents
        </a></span> <span class="next"><a href="/shadow-new-site/configuration/merging/">
          Controlling JAR Content Merging
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/shadow-new-site/assets/js/10.31bb0902.js" defer></script><script src="/shadow-new-site/assets/js/app.28cb96ad.js" defer></script>
  </body>
</html>
